<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>../src/components/graphComponents.js</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title=""></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/LS.ComponentContainer.html">LS.ComponentContainer</a></li>
            
                <li><a href="../classes/LS.Components.Camera.html">LS.Components.Camera</a></li>
            
                <li><a href="../classes/LS.Components.FaceTo.html">LS.Components.FaceTo</a></li>
            
                <li><a href="../classes/LS.Components.FollowNode.html">LS.Components.FollowNode</a></li>
            
                <li><a href="../classes/LS.Components.FPSController.html">LS.Components.FPSController</a></li>
            
                <li><a href="../classes/LS.Components.GeometricPrimitive.html">LS.Components.GeometricPrimitive</a></li>
            
                <li><a href="../classes/LS.Components.GraphComponent.html">LS.Components.GraphComponent</a></li>
            
                <li><a href="../classes/LS.Components.KnobComponent.html">LS.Components.KnobComponent</a></li>
            
                <li><a href="../classes/LS.Components.Light.html">LS.Components.Light</a></li>
            
                <li><a href="../classes/LS.Components.RealtimeReflector.html">LS.Components.RealtimeReflector</a></li>
            
                <li><a href="../classes/LS.Components.Rotator.html">LS.Components.Rotator</a></li>
            
                <li><a href="../classes/LS.Components.Transform.html">LS.Components.Transform</a></li>
            
                <li><a href="../classes/LS.Context.html">LS.Context</a></li>
            
                <li><a href="../classes/LS.LS.html">LS.LS</a></li>
            
                <li><a href="../classes/LS.Material.html">LS.Material</a></li>
            
                <li><a href="../classes/LS.Renderer.html">LS.Renderer</a></li>
            
                <li><a href="../classes/LS.ResourcesManager.html">LS.ResourcesManager</a></li>
            
                <li><a href="../classes/LS.SceneNode.html">LS.SceneNode</a></li>
            
                <li><a href="../classes/LS.SceneTree.html">LS.SceneTree</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: ../src/components/graphComponents.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/* Requires LiteGraph.js ******************************/
if(window.LiteGraph != undefined)
{

	/**
	* This component allow to integrate a behaviour graph on any object
	* @class GraphComponent
	* @param {Object} o object with the serialized info
	*/
	function GraphComponent(o)
	{
		this._graph = new LGraph();
		this.force_redraw = true;
		if(o)
			this.configure(o);
		else //default
		{
			var graphnode = LiteGraph.createNode(&quot;scene/node&quot;);
			this._graph.add(graphnode);
		}
	}

	/**
	* Returns the first component of this container that is of the same class
	* @method configure
	* @param {Object} o object with the configuration info from a previous serialization
	*/
	GraphComponent.prototype.configure = function(o)
	{
		if(o.graph_data)
			this._graph.unserialize( o.graph_data );
	}

	GraphComponent.prototype.serialize = function()
	{
		return { force_redraw: this.force_redraw , graph_data: this._graph.serialize() };
	}

	GraphComponent.prototype.onAddedToNode = function(node)
	{
		this._graph._scenenode = node;
		this._onStart_bind = this.onStart.bind(this);
		this._onUpdate_bind = this.onUpdate.bind(this);
		LEvent.bind(Scene,&quot;start&quot;, this._onStart_bind );
		LEvent.bind(Scene,&quot;update&quot;, this._onUpdate_bind );
	}

	GraphComponent.prototype.onRemovedFromNode = function(node)
	{
		LEvent.unbind(Scene,&quot;start&quot;, this._onStart_bind );
		LEvent.unbind(Scene,&quot;update&quot;, this._onUpdate_bind );
	}

	GraphComponent.prototype.onStart = function()
	{
	}

	GraphComponent.prototype.onUpdate = function(e,dt)
	{
		if(!this._root._on_scene) return;
		if(this._graph)
			this._graph.runStep(1);
		if(this.force_redraw)
			LEvent.trigger(Scene,&quot;change&quot;);
	}


	LS.registerComponent(GraphComponent);
	window.GraphComponent = GraphComponent;


	/* Scene LNodes ***********************/

	/* LGraphNode representing an object in the Scene */

	function LGraphTransform()
	{
		this.properties = {node_id:&quot;&quot;};
		if(LGraphSceneNode._current_node_id)
			this.properties.node_id = LGraphSceneNode._current_node_id;
		this.addInput(&quot;Transform&quot;,&quot;Transform&quot;);
		this.addOutput(&quot;Position&quot;,&quot;vec3&quot;);
	}

	LGraphTransform.title = &quot;Transform&quot;;
	LGraphTransform.desc = &quot;Transform info of a node&quot;;

	LGraphTransform.prototype.onExecute = function()
	{
		var node = this._node;
		if(	this.properties.node_id )
			node = Scene.getNode( this.properties.node_id );

		if(!node)
			node = this.graph._scenenode;

		//read inputs
		for(var i in this.inputs)
		{
			var input = this.inputs[i];
			var v = this.getInputData(i);
			if(v == undefined)
				continue;
			switch( input.name )
			{
				case &quot;Position&quot;: node.transform.setPosition(v); break;
				case &quot;Rotation&quot;: node.transform.setRotation(v); break;
				case &quot;Scale&quot;: node.transform.setScale(v); break;
			}
		}

		//write outputs
		for(var i in this.outputs)
		{
			var output = this.outputs[i];
			if(!output.links || !output.links.length)
				continue;

			switch( output.name )
			{
				case &quot;Position&quot;: this.setOutputData(i, node.transform.getPosition()); break;
				case &quot;Rotation&quot;: this.setOutputData(i, node.transform.getRotation()); break;
				case &quot;Scale&quot;: this.setOutputData(i, node.transform.getScale(scale)); break;
			}
		}

		//this.setOutputData(0, parseFloat( this.properties[&quot;value&quot;] ) );
	}

	LGraphTransform.prototype.onGetInputs = function()
	{
		return [[&quot;Position&quot;,&quot;vec3&quot;],[&quot;Rotation&quot;,&quot;quat&quot;],[&quot;Scale&quot;,&quot;number&quot;],[&quot;Enabled&quot;,&quot;boolean&quot;]];
	}

	LGraphTransform.prototype.onGetOutputs = function()
	{
		return [[&quot;Position&quot;,&quot;vec3&quot;],[&quot;Rotation&quot;,&quot;quat&quot;],[&quot;Scale&quot;,&quot;number&quot;],[&quot;Enabled&quot;,&quot;boolean&quot;]];
	}

	LiteGraph.registerNodeType(&quot;scene/transform&quot;, LGraphTransform );
	window.LGraphTransform = LGraphTransform;

	//***********************************************************************

	function LGraphSceneNode()
	{
		this.properties = {node_id:&quot;&quot;};

		if(LGraphSceneNode._current_node_id)
			this.properties.node_id = LGraphSceneNode._current_node_id;
	}

	LGraphSceneNode.title = &quot;SceneNode&quot;;
	LGraphSceneNode.desc = &quot;Node on the scene&quot;;

	LGraphSceneNode.prototype.getNode = function()
	{
		var node = this._node;
		if(	this.properties.node_id )
			node = Scene.getNode( this.properties.node_id );

		if(!node)
			node = this.graph._scenenode;
		return node;
	}

	LGraphSceneNode.prototype.onExecute = function()
	{
		var node = this.getNode();
	
		//read inputs
		for(var i in this.inputs)
		{
			var input = this.inputs[i];
			var v = this.getInputData(i);
			if(v == undefined)
				continue;
			switch( input.name )
			{
				case &quot;Transform&quot;: node.transform.copyFrom(v); break;
				case &quot;Material&quot;: node.material = v;	break;
				case &quot;Visible&quot;: node.flags.visible = v; break;
			}
		}

		//write outputs
		for(var i in this.outputs)
		{
			var output = this.outputs[i];
			if(!output.links || !output.links.length)
				continue;
			switch( output.name )
			{
				case &quot;Transform&quot;: this.setOutputData(i, node.getTransform() ); break;
				case &quot;Material&quot;: this.setOutputData(i, node.getMaterial() ); break;
				case &quot;Light&quot;: this.setOutputData(i, node.getLight() ); break;
				case &quot;Camera&quot;: this.setOutputData(i, node.getCamera() ); break;
				case &quot;Mesh&quot;: this.setOutputData(i, node.getMesh()); break;
				case &quot;Visible&quot;: this.setOutputData(i, node.flags.visible ); break;
			}
		}
	}

	LGraphSceneNode.prototype.onGetInputs = function()
	{
		return [[&quot;Transform&quot;,&quot;Transform&quot;],[&quot;Material&quot;,&quot;Material&quot;],[&quot;Mesh&quot;,&quot;Mesh&quot;],[&quot;Enabled&quot;,&quot;boolean&quot;]];
	}

	LGraphSceneNode.prototype.onGetOutputs = function()
	{
		var r = [[&quot;Transform&quot;,&quot;Transform&quot;],[&quot;Material&quot;,&quot;Material&quot;],[&quot;Mesh&quot;,&quot;Mesh&quot;],[&quot;Enabled&quot;,&quot;boolean&quot;]];
		var node = this.getNode();
		if(node.light)
			r.push([&quot;Light&quot;,&quot;Light&quot;]);
		if(node.camera)
			r.push([&quot;Camera&quot;,&quot;Camera&quot;]);
		return r;
	}

	LiteGraph.registerNodeType(&quot;scene/node&quot;, LGraphSceneNode );
	window.LGraphSceneNode = LGraphSceneNode;

	//********************************************************

	function LGraphMaterial()
	{
		this.properties = {mat_name:&quot;&quot;};
		this.addInput(&quot;Material&quot;,&quot;Material&quot;);
		this.size = [100,20];
	}

	LGraphMaterial.title = &quot;Material&quot;;
	LGraphMaterial.desc = &quot;Material of a node&quot;;

	LGraphMaterial.prototype.onExecute = function()
	{
		var node = this._node;
		if(	this.properties.node_id )
			node = Scene.getNode( this.properties.node_id );

		if(!node)
			node = this.graph._scenenode;

		var mat = null;
		if(node) //use material of the node
			mat = node.getMaterial();
		//if it has an input material
		var slot = this.findInputSlot(&quot;Material&quot;);
		if( slot != -1)
			mat = this.getInputData(slot);
		if(!mat)
			mat = new Material();

		//read inputs
		for(var i in this.inputs)
		{
			var input = this.inputs[i];
			var v = this.getInputData(i);
			if(v == undefined)
				continue;

			switch( input.name )
			{
				case &quot;Alpha&quot;: mat.alpha = v; break;
				case &quot;Specular f.&quot;: mat.specular_factor = v; break;
				case &quot;Diffuse&quot;: vec3.copy(mat.diffuse,v); break;
				case &quot;Ambient&quot;: vec3.copy(mat.ambient,v); break;
				case &quot;Emissive&quot;: vec3.copy(mat.emissive,v); break;
				case &quot;UVs trans.&quot;: mat.uvs_matrix.set(v); break;
				default:
					if(input.name.substr(0,4) == &quot;Tex.&quot;)
					{
						var channel = input.name.substr(4);
						mat.setTexture(v, channel);
					}
					break;
			}

		}

		//write outputs
		for(var i in this.outputs)
		{
			var output = this.outputs[i];
			if(!output.links || !output.links.length)
				continue;

			var v;
			switch( output.name )
			{
				case &quot;Material&quot;: v = mat; break;
				case &quot;Alpha&quot;: v = mat.alpha; break;
				case &quot;Specular f.&quot;: v = mat.specular_factor; break;
				case &quot;Diffuse&quot;: v = mat.diffuse; break;
				case &quot;Ambient&quot;: v = mat.ambient; break;
				case &quot;Emissive&quot;: v = mat.emissive; break;
				case &quot;UVs trans.&quot;: v = mat.uvs_matrix; break;
				default: continue;
			}
			this.setOutputData(i, v );
		}

		//this.setOutputData(0, parseFloat( this.properties[&quot;value&quot;] ) );
	}

	LGraphMaterial.prototype.onGetInputs = function()
	{
		var results = [[&quot;Material&quot;,&quot;Material&quot;],[&quot;Alpha&quot;,&quot;number&quot;],[&quot;Specular f.&quot;,&quot;number&quot;],[&quot;Diffuse&quot;,&quot;color&quot;],[&quot;Ambient&quot;,&quot;color&quot;],[&quot;Emissive&quot;,&quot;color&quot;],[&quot;UVs trans.&quot;,&quot;texmatrix&quot;]];
		for(var i in Material.TEXTURE_CHANNELS)
			results.push([&quot;Tex.&quot; + Material.TEXTURE_CHANNELS[i],&quot;Texture&quot;]);
		return results;
	}

	LGraphMaterial.prototype.onGetOutputs = function()
	{
		var results = [[&quot;Material&quot;,&quot;Material&quot;],[&quot;Alpha&quot;,&quot;number&quot;],[&quot;Specular f.&quot;,&quot;number&quot;],[&quot;Diffuse&quot;,&quot;color&quot;],[&quot;Ambient&quot;,&quot;color&quot;],[&quot;Emissive&quot;,&quot;color&quot;],[&quot;UVs trans.&quot;,&quot;texmatrix&quot;]];
		for(var i in Material.TEXTURE_CHANNELS)
			results.push([&quot;Tex.&quot; + Material.TEXTURE_CHANNELS[i],&quot;Texture&quot;]);
		return results;
	}

	LiteGraph.registerNodeType(&quot;scene/material&quot;, LGraphMaterial );
	window.LGraphMaterial = LGraphMaterial;

	//********************************************************

	function LGraphLight()
	{
		this.properties = {mat_name:&quot;&quot;};
		this.addInput(&quot;Light&quot;,&quot;Light&quot;);
		this.addOutput(&quot;Intensity&quot;,&quot;number&quot;);
		this.addOutput(&quot;Color&quot;,&quot;color&quot;);
	}

	LGraphLight.title = &quot;Light&quot;;
	LGraphLight.desc = &quot;Light from a scene&quot;;

	LGraphLight.prototype.onExecute = function()
	{
		var node = this._node;
		if(	this.properties.node_id )
			node = Scene.getNode( this.properties.node_id );

		if(!node)
			node = this.graph._scenenode;

		var light = null;
		if(node) //use light of the node
			light = node.getLight();
		//if it has an input light
		var slot = this.findInputSlot(&quot;Light&quot;);
		if( slot != -1 )
			light = this.getInputData(slot);
		if(!light)
			return;

		//read inputs
		for(var i in this.inputs)
		{
			var input = this.inputs[i];
			var v = this.getInputData(i);
			if(v == undefined)
				continue;

			switch( input.name )
			{
				case &quot;Intensity&quot;: light.intensity = v; break;
				case &quot;Color&quot;: vec3.copy(light.color,v); break;
				case &quot;Eye&quot;: vec3.copy(light.eye,v); break;
				case &quot;Center&quot;: vec3.copy(light.center,v); break;
			}
		}

		//write outputs
		for(var i in this.outputs)
		{
			var output = this.outputs[i];
			if(!output.links || !output.links.length)
				continue;

			switch( output.name )
			{
				case &quot;Light&quot;: this.setOutputData(i, light ); break;
				case &quot;Intensity&quot;: this.setOutputData(i, light.intensity ); break;
				case &quot;Color&quot;: this.setOutputData(i, light.color ); break;
				case &quot;Eye&quot;: this.setOutputData(i, light.eye ); break;
				case &quot;Center&quot;: this.setOutputData(i, light.center ); break;
			}
		}
	}

	LGraphLight.prototype.onGetInputs = function()
	{
		return [[&quot;Light&quot;,&quot;Light&quot;],[&quot;Intensity&quot;,&quot;number&quot;],[&quot;Color&quot;,&quot;color&quot;],[&quot;Eye&quot;,&quot;vec3&quot;],[&quot;Center&quot;,&quot;vec3&quot;]];
	}

	LGraphLight.prototype.onGetOutputs = function()
	{
		return [[&quot;Light&quot;,&quot;Light&quot;],[&quot;Intensity&quot;,&quot;number&quot;],[&quot;Color&quot;,&quot;color&quot;],[&quot;Eye&quot;,&quot;vec3&quot;],[&quot;Center&quot;,&quot;vec3&quot;]];
	}

	LiteGraph.registerNodeType(&quot;scene/light&quot;, LGraphLight );
	window.LGraphLight = LGraphLight;

	//********************************************************

	function LGraphScene()
	{
		this.addOutput(&quot;Time&quot;,&quot;number&quot;);
	}

	LGraphScene.title = &quot;Scene&quot;;
	LGraphScene.desc = &quot;Scene&quot;;

	LGraphScene.prototype.onExecute = function()
	{
		//read inputs
		for(var i in this.inputs)
		{
			var input = this.inputs[i];
			var v = this.getInputData(i);
			if(v == undefined)
				continue;

			switch( input.name )
			{
				case &quot;Ambient color&quot;: vec3.copy(Scene.ambient_color,v); break;
				case &quot;Bg Color&quot;: vec3.copy(Scene.background_color,v); break;
			}
		}

		//write outputs
		for(var i in this.outputs)
		{
			var output = this.outputs[i];
			if(!output.links || !output.links.length)
				continue;
			switch( output.name )
			{
				case &quot;Light&quot;: this.setOutputData(i, Scene.light ); break;
				case &quot;Camera&quot;: this.setOutputData(i, Scene.camera ); break;
				case &quot;Ambient color&quot;: this.setOutputData(i, Scene.ambient_color ); break;
				case &quot;Bg Color&quot;: this.setOutputData(i, Scene.background_color ); break;
				case &quot;Time&quot;: this.setOutputData(i, Scene._time ); break;
				case &quot;Elapsed&quot;: this.setOutputData(i, Scene._last_dt != null ? Scene._last_dt : 0); break;
				case &quot;Frame&quot;: this.setOutputData(i, Scene._frame != null ? Scene._frame : 0 ); break;
			}
		}
	}

	LGraphScene.prototype.onGetOutputs = function()
	{
		return [[&quot;Light&quot;,&quot;Light&quot;],[&quot;Camera&quot;,&quot;Camera&quot;],[&quot;Ambient color&quot;,&quot;color&quot;],[&quot;Bg Color&quot;,&quot;color&quot;],[&quot;Elapsed&quot;,&quot;number&quot;],[&quot;Frame&quot;,&quot;number&quot;]];
	}

	LiteGraph.registerNodeType(&quot;scene/scene&quot;, LGraphScene );
	window.LGraphScene = LGraphScene;

	//************************************

	function LGraphGlobal()
	{
		this.addOutput(&quot;Value&quot;,&quot;number&quot;);
		this.properties = {name:&quot;myvar&quot;, value: 0, min:0, max:1 };
	}

	LGraphGlobal.title = &quot;Global&quot;;
	LGraphGlobal.desc = &quot;Global var for the graph&quot;;

	LGraphGlobal.prototype.onExecute = function()
	{
		if(!this.properties.name)
			return;

		this.setOutputData(0, this.properties.value);
	}

	LiteGraph.registerNodeType(&quot;scene/global&quot;, LGraphGlobal );
	window.LGraphGlobal = LGraphGlobal;

	//************************************


	function LGraphTexture()
	{
		this.addOutput(&quot;Texture&quot;,&quot;Texture&quot;);
		this.properties = {name:&quot;&quot;};
	}

	LGraphTexture.title = &quot;Texture&quot;;
	LGraphTexture.desc = &quot;Texture&quot;;

	LGraphTexture.prototype.onExecute = function()
	{
		if(!this.properties.name)
			return;

		var tex = ResourcesManager.textures[ this.properties.name ];
		if(!tex)
			ResourcesManager.loadImage( this.properties.name );
		this.setOutputData(0, tex);
	}

	LiteGraph.registerNodeType(&quot;scene/texture&quot;, LGraphTexture );
	window.LGraphTexture = LGraphTexture;

	//**************************************

	function LGraphTextureOperation()
	{
		this.addInput(&quot;Texture&quot;,&quot;Texture&quot;);
		this.addInput(&quot;TextureB&quot;,&quot;Texture&quot;);
		this.addInput(&quot;value&quot;,&quot;number&quot;);
		this.addOutput(&quot;Texture&quot;,&quot;Texture&quot;);
		this.properties = {value:1, uvcode:&quot;&quot;, pixelcode:&quot;color*2.0&quot;};
		if(!LGraphTextureOperation._mesh) //first time
		{
			var vertices = new Float32Array(18);
			var coords = [-1,-1, 1,1, -1,1,  -1,-1, 1,-1, 1,1 ];
			LGraphTextureOperation._mesh = new GL.Mesh.load({
				vertices: vertices,
				coords: coords});
			Shaders.addGlobalShader( LGraphTextureOperation.vertex_shader, 
									LGraphTextureOperation.pixel_shader,
									&quot;LGraphTextureOperation&quot;,{&quot;UV_CODE&quot;:true,&quot;PIXEL_CODE&quot;:true});
		}
	}

	LGraphTextureOperation.title = &quot;Tex. Op&quot;;
	LGraphTextureOperation.desc = &quot;Texture shader operation&quot;;

	LGraphTextureOperation.prototype.onExecute = function()
	{
		var tex = this.getInputData(0);
		var texB = this.getInputData(1);

		if(!this.properties.uvcode &amp;&amp; !this.properties.pixelcode)
			return;

		var width = 512;
		var height = 512;
		if(tex)
		{
			width = tex.width;
			height = tex.height;
		}
		else if (texB)
		{
			width = texB.width;
			height = texB.height;
		}

		if(!this._tex || this._tex.width != width || this._tex.height != height )
			this._tex = new GL.Texture( width, height, { format: gl.RGBA, filter: gl.LINEAR });

		var uvcode = &quot;&quot;;
		if(this.properties.uvcode)
		{
			uvcode = &quot;uv = &quot; + this.properties.uvcode;
			if(this.properties.uvcode.indexOf(&quot;;&quot;) != -1) //there are line breaks, means multiline code
				uvcode = this.properties.uvcode;
		}
		
		var pixelcode = &quot;&quot;;
		if(this.properties.pixelcode)
		{
			pixelcode = &quot;result = &quot; + this.properties.pixelcode;
			if(this.properties.pixelcode.indexOf(&quot;;&quot;) != -1) //there are line breaks, means multiline code
				pixelcode = this.properties.pixelcode;
		}

		var shader = Shaders.get(&quot;LGraphTextureOperation&quot;, { UV_CODE: uvcode, PIXEL_CODE: pixelcode });
		if(shader)
		{
			var value = this.getInputData(2);
			if(value != null)
				this.properties.value = value;
			else
				value = parseFloat( this.properties.value );

			this._tex.drawTo(function() {
				gl.disable( gl.DEPTH_TEST );
				gl.disable( gl.CULL_FACE );
				gl.disable( gl.BLEND );
				if(tex)	tex.bind(0);
				if(texB) texB.bind(1);
				shader.uniforms({texture:0, textureB:1, value: value, texSize:[width,height], time: Scene._global_time - Scene._start_time}).draw( LGraphTextureOperation._mesh );
			});

			this.setOutputData(0, this._tex);
		}
	}

	LGraphTextureOperation.vertex_shader = &quot;precision highp float;\n\
			attribute vec3 a_vertex;\n\
			attribute vec2 a_coord;\n\
			varying vec2 coord;\n\
			void main() {\n\
				coord = a_coord; gl_Position = vec4(coord * 2.0 - 1.0, 0.0, 1.0);\n\
			}\n\
			&quot;;

	LGraphTextureOperation.pixel_shader = &quot;precision highp float;\n\
			\n\
			uniform sampler2D texture;\n\
			uniform sampler2D textureB;\n\
			varying vec2 coord;\n\
			uniform vec2 texSize;\n\
			uniform float time;\n\
			uniform float value;\n\
			\n\
			void main() {\n\
				vec2 uv = coord;\n\
				UV_CODE;\n\
				vec3 color = texture2D(texture, uv).rgb;\n\
				vec3 colorB = texture2D(textureB, uv).rgb;\n\
				vec3 result = vec3(0.0);\n\
				PIXEL_CODE;\n\
				gl_FragColor = vec4(result, 1.0);\n\
			}\n\
			&quot;;

	LiteGraph.registerNodeType(&quot;scene/textureop&quot;, LGraphTextureOperation );
	window.LGraphTextureOperation = LGraphTextureOperation;
}
    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
