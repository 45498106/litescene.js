function GraphComponent(a){this._graph=new LGraph;this.force_redraw=!0;a&&this.configure(a)}GraphComponent.prototype.configure=function(a){a.graph_data&&this._graph.unserialize(a.graph_data)};GraphComponent.prototype.serialize=function(){return{force_redraw:this.force_redraw,graph_data:this._graph.serialize()}};
GraphComponent.prototype.onAddedToNode=function(){this._onStart_bind=this.onStart.bind(this);this._onUpdate_bind=this.onUpdate.bind(this);LEvent.bind(Scene,"start",this._onStart_bind);LEvent.bind(Scene,"update",this._onUpdate_bind)};GraphComponent.prototype.onRemovedFromNode=function(){LEvent.unbind(Scene,"start",this._onStart_bind);LEvent.unbind(Scene,"update",this._onUpdate_bind)};GraphComponent.prototype.onStart=function(){};
GraphComponent.prototype.onUpdate=function(){this._root._on_scene&&(this._graph&&this._graph.runStep(1),this.force_redraw&&LEvent.trigger(Scene,"change"))};LS.registerComponent(GraphComponent);LiteGraph.registerNodeType("scene/time",{title:"Time",desc:"Time in seconds",outputs:[["time","number"],["elapsed","number"]],onExecute:function(){this.setOutputData(0,null!=Scene._global_time?Scene._global_time:0);this.setOutputData(1,null!=Scene._last_dt?Scene._last_dt:0)}});
LiteGraph.registerNodeType("scene/frame",{title:"Frame",desc:"Number of frame",outputs:[["frame","number"]],onExecute:function(){this.setOutputData(0,null!=Scene._frame?Scene._frame:0)}});function LGraphSceneNode(){this.properties={node_id:""};LGraphSceneNode._current_node_id&&(this.properties.node_id=LGraphSceneNode._current_node_id)}LGraphSceneNode.title="SceneNode";LGraphSceneNode.desc="Node on the scene";
LGraphSceneNode.prototype.onExecute=function(){var a=this._node;this.properties.node_id&&(a=Scene.getNode(this.properties.node_id));if(a){for(var b in this.inputs)switch(this.inputs[b].name){case "Position":var c=this.getInputData(b);void 0!=c&&a.transform.setPosition(c);break;case "Rotation":c=this.getInputData(b);void 0!=c&&a.transform.setRotation(c);break;case "Scale":var d=this.getInputData(b);void 0!=d&&a.transform.setScale(d);break;case "Enabled":c=this.getInputData(b),void 0!=c&&(a.flags.visible=
c)}for(b in this.outputs)switch(this.outputs[b].name){case "Position":this.setOutputData(b,a.transform.getPosition());break;case "Rotation":this.setOutputData(b,a.transform.getRotation());break;case "Scale":this.setOutputData(b,a.transform.getScale(d));break;case "Enabled":this.setOutputData(b,a.flags.visible)}}};LGraphSceneNode.prototype.onGetInputs=function(){return[["Position","vec3"],["Rotation","quat"],["Scale","number"],["Enabled","boolean"]]};
LGraphSceneNode.prototype.onGetOutputs=function(){return[["Position","vec3"],["Rotation","quat"],["Scale","number"],["Enabled","boolean"]]};LiteGraph.registerNodeType("scene/node",LGraphSceneNode);
